# values.yaml for hello-world Python Application (2026)

# --- Cluster Scaling ---
replicaCount: 1

# --- Labels ---
selector:
  matchLabels:
    app: hello-world
    tier: backend

podLabels:
  app: hello-world
  tier: backend
  version: "1.0"

# --- Container Image ---
image:
  repository: "myacr.azurecr.io/hello-world-python"
  pullPolicy: Always
  # Overridden by CI/CD during deployment
  tag: "latest"

# --- Database Connectivity ---
database:
  # TOGGLE: Set to "primary" for East US or "secondary" for West US 2
  activeProfile: "primary"

  # Connection Details (Found in Azure Portal or Terraform Outputs)
  primaryHost: "primary-psql-2026.postgres.database.azure.com"
  secondaryHost: "secondary-psql-2026.postgres.database.azure.com"

  # Authentication
  dbUser: "psqladmin"
  dbName: "postgres"

  # Secret Reference: The name of the K8s secret containing the password
  # Note: The secret must have a key named 'password'
  passwordSecretName: "db-credentials"

# --- Kubernetes Service ---
service:
  type: ClusterIP
  port: 80
  targetPort: 8080

ingress:
  enabled: true
  className: "traefik"
  # Use your Front Door default hostname
  host: "fd-endpoint-2026-hnfbhtb3begrh3hr.a01.azurefd.net"
  path: /
  pathType: Prefix

# --- Environment Variables (Static) ---
env:
  - name: ENVIRONMENT
    value: "production"
  - name: APP_NAME
    value: "hello-world-multi-region"
  - name: PORT
    value: "8080"

# --- Resource Management (2026 Best Practices) ---
resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 300m
    memory: 256Mi

# --- Health Checks ---
livenessProbe:
  httpGet:
    path: /healthz
    port: 8080
  initialDelaySeconds: 15
  periodSeconds: 20

readinessProbe:
  httpGet:
    path: /health
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 10

# --- Security Context ---
# Required for many production AKS policies in 2026
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

serviceAccount:
  create: true
  name: "hello-world-sa"
